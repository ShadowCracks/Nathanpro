import{u as y,a as b,r as x,j as t,b as f}from"./index-C0hSWP-4.js";var g="basil",E=function(e){return e===3?"v3":e},j="https://js.stripe.com",N="".concat(j,"/").concat(g,"/stripe.js"),P=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,L=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var k=function(e){return P.test(e)||L.test(e)},R=function(){for(var e=document.querySelectorAll('script[src^="'.concat(j,'"]')),r=0;r<e.length;r++){var n=e[r];if(k(n.src))return n}return null},v=function(e){var r="",n=document.createElement("script");n.src="".concat(N).concat(r);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},C=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.0",startTime:r})},c=null,p=null,m=null,T=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},I=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},V=function(e){return c!==null?c:(c=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var s=R();if(!(s&&e)){if(!s)s=v(e);else if(s&&m!==null&&p!==null){var i;s.removeEventListener("load",m),s.removeEventListener("error",p),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=v(e)}}m=I(r,n),p=T(n),s.addEventListener("load",m),s.addEventListener("error",p)}catch(l){n(l);return}}),c.catch(function(r){return c=null,Promise.reject(r)}))},G=function(e,r,n){if(e===null)return null;var s=r[0],i=s.match(/^pk_test/),l=E(e.version),o=g;i&&l!==o&&console.warn("Stripe.js@".concat(l," was loaded on the page, but @stripe/stripe-js@").concat("7.3.0"," expected Stripe.js@").concat(o,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var d=e.apply(void 0,r);return C(d,n),d},u,S=!1,w=function(){return u||(u=V(null).catch(function(e){return u=null,Promise.reject(e)}),u)};Promise.resolve().then(function(){return w()}).catch(function(a){S||console.warn(a)});var U=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];S=!0;var s=Date.now();return w().then(function(i){return G(i,r,s)})};const W=U("pk_test_51RSRcs2ZmQffBPtGHmVVtpyuNZuWOf6t5iMAVfagJBe5230PKzbuJzdU6IFNPIbDSc5xN9QDxQVJ8xGBBURZrDbF00GRYQwJaG"),A=()=>{const a=y(),{user:e,logout:r}=b(),[n,s]=x.useState(!1);x.useEffect(()=>{e!=null&&e.hasPurchasedCourse&&a("/course")},[e,a]);const i=async()=>{var l;s(!0);try{const o=await f.post("https://nathanpro.onrender.com/api/stripe/create-checkout",{productType:"course"}),d=await W,{error:h}=await d.redirectToCheckout({sessionId:o.data.sessionId});h&&(console.error("Stripe error:",h),alert("Payment failed. Please try again."))}catch(o){console.error("Purchase error:",o),f.isAxiosError(o)&&((l=o.response)==null?void 0:l.status)===401?(alert("Your session has expired. Please sign in again."),a("/signin")):alert("Failed to initiate purchase. Please try again.")}finally{s(!1)}};return e?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"max-w-2xl w-full bg-white rounded-lg shadow-lg p-8",children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Purchase"}),t.jsxs("p",{className:"text-gray-600",children:["Welcome, ",e.name||e.email,"! You're one step away from accessing the course."]})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Course Features"}),t.jsxs("ul",{className:"space-y-3",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-6 h-6 text-green-500 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t.jsx("span",{className:"text-gray-700",children:"Lifetime access to all course materials"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-6 h-6 text-green-500 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t.jsx("span",{className:"text-gray-700",children:"High-quality video tutorials"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("svg",{className:"w-6 h-6 text-green-500 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),t.jsx("span",{className:"text-gray-700",children:"Regular updates and new content"})]})]})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-3xl font-bold text-gray-800 mb-6",children:"$99.00"}),t.jsx("button",{onClick:i,disabled:n,className:`px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition ${n?"opacity-50 cursor-not-allowed":""}`,children:n?"Processing...":"Purchase Course"}),t.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Secure payment powered by Stripe"})]}),t.jsx("button",{onClick:r,className:"mt-6 text-sm text-gray-600 hover:text-gray-800 underline block mx-auto",children:"Sign out"})]})}):null};export{A as default};
